knitr::opts_chunk$set(echo = TRUE)
library(DT)
df <- read.csv("births14.csv")
datatable(df, options = list(scrollX = TRUE))
hist(df$mage, breaks = 12, probability = TRUE, main = "Histograma de edades", xlab = "mage", xlim = c(14, 47), ylim = c(0, 0.08))
curve(dnorm(x, mean(df$mage), sd(df$mage)), from = 15, to = 45, add = TRUE, col = "red")
text(40, 0.07, paste("media: ", round(mean(df$mage), 2)))
hist(df$weeks, breaks = 20, probability = TRUE, main = "Histograma de semanas en gestacion", xlab = "weeks", xlim = c(21, 46), ylim = c(0, 0.3))
curve(dnorm(x, mean(df$weeks), sd(df$weeks)), from = 15, to = 45, add = TRUE, col = "red")
text(26, 0.2, paste("media: ", round(mean(df$weeks), 2)))
barplot(table(df$premie))
hist(na.omit(df$visits), breaks = 20, probability = TRUE, main = "Histograma de visitas", xlab = "Visitas", xlim = c(0, 30), ylim = c(0, 0.13))
curve(dnorm(x, mean(na.omit(df$visits)), sd(na.omit(df$visits))), from = 0, to = 30, add = TRUE, col = "red")
text(25, 0.1, paste("media: ", round(mean(na.omit(df$visits)), 2)))
visits_NA_as_0 <- ifelse(is.na(df$visits), 0, df$visits)
hist(visits_NA_as_0, breaks = 20, probability = TRUE, main = "Histograma de visitas", xlab = "Visitas", xlim = c(0, 30), ylim = c(0, 0.13))
curve(dnorm(x, mean(visits_NA_as_0), sd(visits_NA_as_0)), from = 0, to = 30, add = TRUE, col = "red")
text(25, 0.1, paste("media: ", round(mean(visits_NA_as_0), 2)))
hist(na.omit(df$gained), breaks = 20, probability = TRUE, main = "Histograma de peso ganado en el embarazo", xlab = "Visitas", xlim = c(0, 98), ylim = c(0, 0.04))
curve(dnorm(x, mean(na.omit(df$gained)), sd(na.omit(df$gained))), from = 0, to = 98, add = TRUE, col = "red")
text(80, 0.03, paste("media: ", round(mean(na.omit(df$gained)), 2)))
gained_NA_as_0 <- ifelse(is.na(df$gained), 0, df$gained)
hist(gained_NA_as_0, breaks = 20, probability = TRUE, main = "Histograma de peso ganado en el embarazo", xlab = "Visitas", xlim = c(0, 98), ylim = c(0, 0.04))
curve(dnorm(x, mean(gained_NA_as_0), sd(gained_NA_as_0)), from = 0, to = 98, add = TRUE, col = "red")
text(80, 0.03, paste("media: ", round(mean(gained_NA_as_0), 2)))
hist(df$weight, breaks = 20, probability = TRUE, main = "Histograma de pesos en libras", xlab = "weight", xlim = c(0.75, 10.62), ylim = c(0, 0.4))
curve(dnorm(x, mean(df$weight), sd(df$weight)), from = 0.75, to = 10.62, add = TRUE, col = "red")
text(3, 0.3, paste("media: ", round(mean(df$weight), 2)))
barplot(table(df$lowbirthweight))
barplot(table(df$habit))
# "younger mom" = 0, "mature mom" = 1
df$mature <- ifelse(df$mature == "younger mom", 0, ifelse(df$mature == "mature mom", 1, df$mature))
df$mature <- as.numeric(df$mature)
# "full term" = 0, "premie" = 1
df$premie <- ifelse(df$premie == "full term", 0, ifelse(df$premie == "premie", 1, df$premie))
df$premie <- as.numeric(df$premie)
# "not low" = 0, "low" = 1
df$lowbirthweight <- ifelse(df$lowbirthweight == "not low", 0, ifelse(df$lowbirthweight == "low", 1, df$lowbirthweight))
df$lowbirthweight <- as.numeric(df$lowbirthweight)
# "male" = 0, "female" = 1
df$sex <- ifelse(df$sex == "male", 0, ifelse(df$sex == "female", 1, df$sex))
df$sex <- as.numeric(df$sex)
# "nonsmoker" = 0, "smoker" = 1
df$habit <- ifelse(df$habit == "nonsmoker", 0, ifelse(df$habit == "smoker", 1, df$habit))
df$habit <- as.numeric(df$habit)
# "not married" = 0, "married" = 1
df$marital <- ifelse(df$marital == "not married", 0, ifelse(df$marital == "married", 1, df$marital))
df$marital <- as.numeric(df$marital)
# "not white" = 0, "white" = 1
df$whitemom <- ifelse(df$whitemom == "not white", 0, ifelse(df$whitemom == "white", 1, df$whitemom))
df$whitemom <- as.numeric(df$whitemom)
df <- subset(df, select = -fage)
df <- df[!is.na(df$visits), ]
df <- df[!is.na(df$gained), ]
df <- df[!is.na(df$habit), ]
View(df)
mom_gained <- df$gained
birth_weight <- df$weight
x_bar <- mean(mom_gained)
y_bar <- mean(birth_weight)
mom_gained <- df$gained
birth_weight <- df$weight
x_bar <- mean(mom_gained)
y_bar <- mean(birth_weight)
print("n = " length(mom_gained))
mom_gained <- df$gained
birth_weight <- df$weight
x_bar <- mean(mom_gained)
y_bar <- mean(birth_weight)
print("n = " + length(mom_gained))
mom_gained <- df$gained
birth_weight <- df$weight
x_bar <- mean(mom_gained)
y_bar <- mean(birth_weight)
print(paste("n = ", length(mom_gained)))
mom_gained <- df$gained
birth_weight <- df$weight
x_bar <- mean(mom_gained)
y_bar <- mean(birth_weight)
print(paste("n = %d", length(mom_gained)))
mom_gained <- df$gained
birth_weight <- df$weight
x_bar <- mean(mom_gained)
y_bar <- mean(birth_weight)
print(paste("n =", length(mom_gained)))
mom_gained <- df$gained
birth_weight <- df$weight
x_bar <- mean(mom_gained)
y_bar <- mean(birth_weight)
print(paste("n =", length(mom_gained)))
B1_est = sum((mom_gained-x_bar)*(birth_weight-y_bar))/sum((mom_gained-x_bar)**2)
B1_est = sum((mom_gained-x_bar)*(birth_weight-y_bar))/sum((mom_gained-x_bar)**2)
B0_est = y_bar - (B1_est*x_bar)
trigo <- c(30, 28, 32, 25, 25, 25, 22, 24, 35, 40)
precio <- c(25, 30, 27, 40, 42, 40, 50, 45, 30, 25)
# Se calcula el promedio de cada una de las variables
ybarra <- mean(precio)
xbarra <- mean(trigo)
# Se estima el valor de la pendiente y del intercepto para la recta de regresiÃ³n:
estimado_b1 = sum((trigo - xbarra)*(precio - ybarra))/sum((trigo - xbarra)**2)
estimado_b0 = ybarra-estimado_b1*xbarra
knitr::opts_chunk$set(echo = TRUE)
library(DT)
df <- read.csv("births14.csv")
datatable(df, options = list(scrollX = TRUE))
hist(df$mage, breaks = 12, probability = TRUE, main = "Histograma de edades", xlab = "mage", xlim = c(14, 47), ylim = c(0, 0.08))
curve(dnorm(x, mean(df$mage), sd(df$mage)), from = 15, to = 45, add = TRUE, col = "red")
text(40, 0.07, paste("media: ", round(mean(df$mage), 2)))
hist(df$weeks, breaks = 20, probability = TRUE, main = "Histograma de semanas en gestacion", xlab = "weeks", xlim = c(21, 46), ylim = c(0, 0.3))
curve(dnorm(x, mean(df$weeks), sd(df$weeks)), from = 15, to = 45, add = TRUE, col = "red")
text(26, 0.2, paste("media: ", round(mean(df$weeks), 2)))
barplot(table(df$premie))
hist(na.omit(df$visits), breaks = 20, probability = TRUE, main = "Histograma de visitas", xlab = "Visitas", xlim = c(0, 30), ylim = c(0, 0.13))
curve(dnorm(x, mean(na.omit(df$visits)), sd(na.omit(df$visits))), from = 0, to = 30, add = TRUE, col = "red")
text(25, 0.1, paste("media: ", round(mean(na.omit(df$visits)), 2)))
visits_NA_as_0 <- ifelse(is.na(df$visits), 0, df$visits)
hist(visits_NA_as_0, breaks = 20, probability = TRUE, main = "Histograma de visitas", xlab = "Visitas", xlim = c(0, 30), ylim = c(0, 0.13))
curve(dnorm(x, mean(visits_NA_as_0), sd(visits_NA_as_0)), from = 0, to = 30, add = TRUE, col = "red")
text(25, 0.1, paste("media: ", round(mean(visits_NA_as_0), 2)))
hist(na.omit(df$gained), breaks = 20, probability = TRUE, main = "Histograma de peso ganado en el embarazo", xlab = "Visitas", xlim = c(0, 98), ylim = c(0, 0.04))
curve(dnorm(x, mean(na.omit(df$gained)), sd(na.omit(df$gained))), from = 0, to = 98, add = TRUE, col = "red")
text(80, 0.03, paste("media: ", round(mean(na.omit(df$gained)), 2)))
gained_NA_as_0 <- ifelse(is.na(df$gained), 0, df$gained)
hist(gained_NA_as_0, breaks = 20, probability = TRUE, main = "Histograma de peso ganado en el embarazo", xlab = "Visitas", xlim = c(0, 98), ylim = c(0, 0.04))
curve(dnorm(x, mean(gained_NA_as_0), sd(gained_NA_as_0)), from = 0, to = 98, add = TRUE, col = "red")
text(80, 0.03, paste("media: ", round(mean(gained_NA_as_0), 2)))
hist(df$weight, breaks = 20, probability = TRUE, main = "Histograma de pesos en libras", xlab = "weight", xlim = c(0.75, 10.62), ylim = c(0, 0.4))
curve(dnorm(x, mean(df$weight), sd(df$weight)), from = 0.75, to = 10.62, add = TRUE, col = "red")
text(3, 0.3, paste("media: ", round(mean(df$weight), 2)))
barplot(table(df$lowbirthweight))
barplot(table(df$habit))
# "younger mom" = 0, "mature mom" = 1
df$mature <- ifelse(df$mature == "younger mom", 0, ifelse(df$mature == "mature mom", 1, df$mature))
df$mature <- as.numeric(df$mature)
# "full term" = 0, "premie" = 1
df$premie <- ifelse(df$premie == "full term", 0, ifelse(df$premie == "premie", 1, df$premie))
df$premie <- as.numeric(df$premie)
# "not low" = 0, "low" = 1
df$lowbirthweight <- ifelse(df$lowbirthweight == "not low", 0, ifelse(df$lowbirthweight == "low", 1, df$lowbirthweight))
df$lowbirthweight <- as.numeric(df$lowbirthweight)
# "male" = 0, "female" = 1
df$sex <- ifelse(df$sex == "male", 0, ifelse(df$sex == "female", 1, df$sex))
df$sex <- as.numeric(df$sex)
# "nonsmoker" = 0, "smoker" = 1
df$habit <- ifelse(df$habit == "nonsmoker", 0, ifelse(df$habit == "smoker", 1, df$habit))
df$habit <- as.numeric(df$habit)
# "not married" = 0, "married" = 1
df$marital <- ifelse(df$marital == "not married", 0, ifelse(df$marital == "married", 1, df$marital))
df$marital <- as.numeric(df$marital)
# "not white" = 0, "white" = 1
df$whitemom <- ifelse(df$whitemom == "not white", 0, ifelse(df$whitemom == "white", 1, df$whitemom))
df$whitemom <- as.numeric(df$whitemom)
df <- subset(df, select = -fage)
df <- df[!is.na(df$visits), ]
df <- df[!is.na(df$gained), ]
df <- df[!is.na(df$habit), ]
mom_gained <- df$gained
birth_weight <- df$weight
x_bar <- mean(mom_gained)
y_bar <- mean(birth_weight)
print(paste("n =", length(mom_gained)))
B1_est = sum((mom_gained-x_bar)*(birth_weight-y_bar))/sum((mom_gained-x_bar)**2)
B0_est = y_bar - (B1_est*x_bar)
plot(mom_gained, birth_weight)
curve()
plot(mom_gained, birth_weight)
curve(B0_est+B1_est*x, add = TRUE, col = "blue")
plot(mom_gained, birth_weight)
curve(B0_est+B1_est*x, add = TRUE, col = "red")
plot(mom_gained, birth_weight)
curve(B0_est+B1_est*x, add = TRUE, col = "cyan")
plot(mom_gained, birth_weight)
curve(B0_est+B1_est*x, add = TRUE, col = "brick")
plot(mom_gained, birth_weight)
curve(B0_est+B1_est*x, add = TRUE, col = "purple")
plot(mom_gained, birth_weight)
curve(B0_est+B1_est*x, add = TRUE, col = "red")
plot(mom_gained, birth_weight)
curve(B0_est+B1_est*x, add = TRUE, col = "darkolivegreen4")
plot(mom_gained, birth_weight)
curve(B0_est+B1_est*x, add = TRUE, col = "brown1")
plot(mom_gained, birth_weight)
curve(B0_est+B1_est*x, add = TRUE, col = "deeppink")
plot(mom_gained, birth_weight)
curve(B0_est+B1_est*x, add = TRUE, col = "deeppink")
text(80, 3, paste("B_0=", round(B0_est, 2)))
text(80, 2, paste("B_1=", round(B1_est, 2)))
plot(mom_gained, birth_weight)
curve(B0_est+B1_est*x, add = TRUE, col = "deeppink")
text(80, 3, paste("B_0=", round(B0_est, 2)))
text(80, 2.5, paste("B_1=", round(B1_est, 2)))
plot(mom_gained, birth_weight)
curve(B0_est+B1_est*x, add = TRUE, col = "deeppink")
text(80, 3.5, paste("B_0=", round(B0_est, 2)))
text(80, 2, paste("B_1=", round(B1_est, 2)))
plot(mom_gained, birth_weight)
curve(B0_est+B1_est*x, add = TRUE, col = "deeppink")
text(80, 3.5, paste("B_0=", round(B0_est, 2)))
text(80, 3, paste("B_1=", round(B1_est, 2)))
plot(mom_gained, birth_weight)
curve(B0_est+B1_est*x, add = TRUE, col = "deeppink")
text(80, 3.5, paste("B_0=", round(B0_est, 2)))
text(80, 2.8, paste("B_1=", round(B1_est, 2)))
mom_gained <- df$gained
birth_weight <- df$weight
x_bar <- mean(mom_gained)
y_bar <- mean(birth_weight)
n = length(mom_gained)
print(paste("n =", n))
plot(mom_gained, birth_weight)
curve(B0_est+B1_est*x, add = TRUE, col = "deeppink")
text(80, 3.5, paste("B_0=", round(B0_est, 2)))
text(80, 2.8, paste("B_1=", round(B1_est, 3)))
errors = birth_weight - (B0_est+(B1_est*mom_gained))
r_var = sum(errors**2)/(n-2)
-0.8471402**2
errors = birth_weight - (B0_est+(B1_est*mom_gained))
re_var = sum(errors**2)/(n-2)
sce = sum(errors**2)
stcc = sum((birth_weight-y_bar)**2)
r2 = 1 - sce/stcc
r = cor(mom_gained, birth_weight)
r**2
